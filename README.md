# Amazon Music Trigger (AmazonMusic-PlayNow)

イヤホンの「曲送り（Next）」ボタンを2回押すことで、Amazon Musicの「My BGM（My Soundtrack）」を即座に再生するAndroidアプリです。

## 概要

このアプリはAndroidのユーザー補助サービス（Accessibility Service）を利用して、メディアボタンの入力を監視します。
通常、イヤホンの「曲送り」ボタンを押すと次の曲へスキップしますが、このアプリを有効にすると以下の挙動になります：

- **1回押し**: 通常通り「次の曲」へスキップします（誤作動防止のため、わずかな遅延があります）。
- **2回早押し（ダブルクリック）**: Amazon Musicアプリを起動し、「My BGM」ステーションを再生します。

「My BGM」を一発で呼び出したいAmazon Musicユーザー向けの便利ツールです。

## 機能

- **ダブルクリックで再生**: ヘッドセットやBluetoothイヤホンの「曲送り」ボタンをダブルクリックすると `amzn://music/station/mysoundtrack` インテントを発行し、My BGMを再生します。
- **通常の操作も維持**: シングルクリックの場合は、本来の「曲送り」操作が行われます。

## 動作環境

- Android 8.0 (API Level 26) 以上
- Amazon Music アプリがインストールされていること

## セットアップ方法

1. アプリをインストールして起動します。
2. **「ユーザー補助設定を開く」** ボタンをタップします。
3. ユーザー補助のリストから **「Amazon Music Trigger」** を探し、スイッチを **ON** にします。
   - 警告が表示されますが、メディアボタンの監視に必要な権限です。許可してください。
4. (必要な場合) **「オーバーレイ権限の設定」** ボタンから、「他のアプリの上に重ねて表示」を許可してください（バックグラウンドからの起動に必要になる場合があります）。

## 使い方

1. セットアップ完了後、Bluetoothイヤホンなどを接続します。
2. 音楽を聴いていない時や、Amazon Music操作中に、イヤホンの「曲送り」ボタンをカチカチっと **2回素早く** 押してください。
3. 「My BGM起動」というトーストが表示され、Amazon MusicのMy Soundtrackが再生されます。

## 開発者向け情報

このプロジェクトはKotlinで記述されており、`AccessibilityService` を拡張して `KeyEvent.KEYCODE_MEDIA_NEXT` をフックしています。

- **MainActivity.kt**: 権限設定への誘導UI。
- **TriggerService.kt**: バックグラウンドでキーイベントを監視するコアロジック。